<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Test</title>
        <script type="text/javascript" src="../d3testing/d3/d3.v3.js"></script>
    </head>
    <body bgcolor="black">
<script type="text/javascript">
        
    var dataset;  //Global variable
    var w = 1000;
    var h = 1000;
    var svg = d3.select('body')
                .append('svg')
                .attr('width', w)
                .attr('height',h)
                .attr('fill', 'black');

// Main Iterator    
    d3.tsv("cat_eg.tsv", function(data) {
        dataset = data;
        animate();
    });    
         
        
    
// Animate    
    function animate(){
        svg.selectAll('text.cat')
            .data(dataset)
            .enter()
            .append('text')
            .attr('class','cat')
            .text(function(d){return d.alchemy_category;})
                .attr('x', w/6)
                .attr('y', function(d, i){return (i*h/dataset.length) + 50;})
                .attr('text-anchor', 'middle')
                .attr('fill', 'black')
                .attr("dy", ".35em")
                .style("font-size",function(d){return d.evergreen*50 + 'px';})
                .attr('font-family', 'sans-serif')
                .style("font-weight", "bold")
                .style('fill',function(d){
                    if (d.evergreen<=0.33)
                    {return 'red'}
                    else if (d.evergreen<=0.66)
                    {return 'yellow'}
                    else
                    {return 'green'};
                })
                .on('click', highlight)
        ;
    };    
    
    
// Highlight    
    function highlight(){
        var self = this;
        d3.select(this).style('fill',function(d){  
            if (d.evergreen<=0.33)
                    {return 'red'}
                    else if (d.evergreen<=0.66)
                    {return 'yellow'}
                    else
                    {return 'green'};
                })
            
        d3.selectAll('svg text.cat').filter(function(x){ return self != this;})
            .transition()
                .style('fill','grey')   
        ;    
    };
        
                
            
</script>
    </body>
</html>     